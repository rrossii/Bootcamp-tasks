<template>
    <lightning-card title="Create Contacts (max 5 Contacts per Account)">
        <template for:each={contacts} for:item="contact" for:index="index">
            <div key={contact.id} class="slds-grid slds-grid_align-space slds-m-left_x-small slds-m-right_x-small" >
                <div class="slds-col">
                    <lightning-input 
                        data-id={contact.id} data-field="FirstName" value={contact.FirstName} 
                        type="text" label="First Name" onchange={handleInputChange}
                        disabled={contact.isExisting}
                        required>
                    </lightning-input>
                </div>
                <div class="slds-col">
                    <lightning-input 
                        data-id={contact.id} data-field="LastName" value={contact.LastName} 
                        type="text" label="Last Name" onchange={handleInputChange}
                        disabled={contact.isExisting}
                        required>
                    </lightning-input>
                </div>
                <div class="slds-col">
                    <lightning-input 
                        data-id={contact.id} data-field="Birthdate" value={contact.Birthdate} 
                        type="date" label="Date of Birth" onchange={handleInputChange}
                        disabled={contact.isExisting}>
                    </lightning-input>
                </div>
                <template if:false={contact.isChild}>
                    <div class="slds-col">
                        <lightning-input 
                            data-id={contact.id} data-field="Email" value={contact.Email} 
                            type="email" label="Email" onchange={handleInputChange}
                            disabled={contact.isExisting}
                            required>
                        </lightning-input>
                    </div>
                </template>
                <div class="slds-col">
                    <lightning-input 
                        data-id={contact.id} data-field="LeadSource" value={contact.LeadSource} 
                        type="text" label="Lead Source" onchange={handleInputChange}
                        disabled={contact.isExisting}> 
                    </lightning-input>
                </div>
                <template if:false={contact.isExisting}>
                    <div class="slds-m-top_large">
                        <lightning-icon 
                            data-id={contact.id}
                            icon-name="utility:delete" 
                            size="small"
                            onclick={handleDeleteContactRow}>
                        </lightning-icon>
                    </div>
                </template>
            </div>
            <template if:true={contact.isChild}>
                <div key={contact.id} class="slds-grid slds-grid_align-end slds-m-right_x-small">
                    <div class="slds-col">
                        <lightning-input 
                            data-id={contact.id} data-field="MotherFirstName" value={contact.MotherFirstName} 
                            type="text" label="Mother's first name" onchange={handleInputChange}
                            required>
                        </lightning-input>
                    </div>
                    <div class="slds-col">
                        <lightning-input 
                            data-id={contact.id} data-field="MotherLastName" value={contact.MotherLastName} 
                            type="text" label="Mother's last name" onchange={handleInputChange}
                            required>
                        </lightning-input>
                    </div>
                    <div class="slds-col">
                        <lightning-input 
                            data-id={contact.id} data-field="MotherEmail" value={contact.MotherEmail} 
                            type="email" label="Mother's Email" onchange={handleInputChange}
                            required>
                        </lightning-input>
                    </div>
                </div>
                <div key={contact.id} class="slds-grid slds-grid_align-end slds-m-right_x-small">
                    <div class="slds-col">
                        <lightning-input 
                            data-id={contact.id} data-field="FatherFirstName" value={contact.FatherFirstName} 
                            type="text" label="Father's first name" onchange={handleInputChange}
                            required>
                        </lightning-input>
                    </div>
                    <div class="slds-col">
                        <lightning-input 
                            data-id={contact.id} data-field="FatherLastName" value={contact.FatherLastName} 
                            type="text" label="Father's last name" onchange={handleInputChange}
                            required>
                        </lightning-input>
                    </div>
                    <div class="slds-col">
                        <lightning-input 
                            data-id={contact.id} data-field="FatherEmail" value={contact.FatherEmail} 
                            type="email" label="Father's Email" onchange={handleInputChange}
                            required>
                        </lightning-input> 
                    </div>
                </div>
            </template>
        </template>

        <div class="slds-grid slds-grid_align-spread slds-m-top_x-small">
            <template if:false={contactsLengthIsMaximum}>
                <lightning-button 
                    class="slds-m-left_x-small" 
                    variant="brand" label="Add Contact row" title="Add Contact"
                    onclick={handleAddContactRow}>
                </lightning-button>
            </template>
            <template if:true={contactsLengthIsMaximum}>
                <p class="slds-m-left_x-small slds-m-top_x-small">
                    You've already reached the maximum (5) of Contacts per Account.
                </p>
            </template>
            <template if:true={hasNonExistingContacts}>
                <lightning-button 
                    class="slds-m-right_x-small" 
                    variant="brand-outline" label="Create Contacts" title="Create Contacts"
                    onclick={handleCreateContacts}>
                </lightning-button>
            </template>
        </div>
    </lightning-card>
</template>