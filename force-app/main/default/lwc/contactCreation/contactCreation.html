<template>
    <lightning-card title="Create Contacts (max 5 Contacts per Account)">
        <template for:each={contacts} for:item="contact" for:index="index">
            <div key={contact.id} class="slds-grid slds-grid_align-space slds-m-left_x-small slds-m-right_x-small" >
                <div class="slds-col">
                    <lightning-input 
                        data-id={contact.id} data-field="FirstName" value={contact.FirstName} 
                        type="text" label="First Name" onchange={handleInputChange}
                        disabled={contact.isExisting}>
                    </lightning-input>
                </div>
                <div class="slds-col">
                    <lightning-input 
                        data-id={contact.id} data-field="LastName" value={contact.LastName} 
                        type="text" label="Last Name" onchange={handleInputChange}
                        disabled={contact.isExisting}
                        required>
                    </lightning-input>
                </div>
                <div class="slds-col">
                    <lightning-input 
                        data-id={contact.id} data-field="Birthdate" value={contact.Birthdate} 
                        type="date" label="Date of Birth" onchange={handleInputChange}
                        disabled={contact.isExisting}>
                    </lightning-input>
                </div>
                <div class="slds-col">
                    <lightning-input 
                        data-id={contact.id} data-field="Email" value={contact.Email} 
                        type="email" label="Email" onchange={handleInputChange}
                        disabled={contact.isExisting}
                        required>
                    </lightning-input>
                </div>
                <div class="slds-col">
                    <lightning-input 
                        data-id={contact.id} data-field="LeadSource" value={contact.LeadSource} 
                        type="text" label="Lead Source" onchange={handleInputChange}
                        disabled={contact.isExisting}> 
                    </lightning-input>
                </div>
                <template if:false={contact.isExisting}>
                    <div class="slds-m-top_large">
                        <lightning-icon 
                            data-id={contact.id}
                            icon-name="utility:delete" 
                            size="small"
                            onclick={handleDeleteContactRow}>
                        </lightning-icon>
                    </div>
                </template>

            </div>
        </template>

        <div class="slds-grid slds-grid_align-spread">
            <template if:false={contactsLengthIsMaximum}>
                <lightning-button 
                    class="slds-m-left_x-small" 
                    variant="brand" label="Add Contact row" title="Add Contact"
                    onclick={handleAddContactRow}>
                </lightning-button>
            </template>
            <template if:true={contactsLengthIsMaximum}>
                <p class="slds-m-left_x-small slds-m-top_x-small">
                    You've already reached the maximum (5) of Contacts per Account.
                </p>
            </template>
            <template if:true={hasNonExistingContacts}>
                <lightning-button 
                    class="slds-m-right_x-small" 
                    variant="brand-outline" label="Create Contacts" title="Create Contacts"
                    onclick={handleCreateContacts}>
                </lightning-button>
            </template>
        </div>
    </lightning-card>
</template>